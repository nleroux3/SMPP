subroutine metamorphism(q)
USE Declarations
implicit none
real*8 :: velocity,vo,b
integer*4 :: q

vo=1.28/(10**(8))
b=4.22/(10**(4))


DO i=1,N-1

	DO j=1,M-1
		
		IF ((water_content(i,j,1).LE.0.1) .AND. (water_content(i,j,1).GT.0.)) THEN

			velocity=(vo+b*(water_content(i,j,1))**3)   ! (Brun, 1989)  [mm3/s]  
			! water content is in decimal value, the 100e3 is added to "b"
	
		ELSE
			velocity=0.
		ENDIF

		!grain_size(i,j)= 2.*(3./(4.*3.14)*((grain_size_ini(i,j)/2.)**3*4./3.*3.14+(q*Dt*velocity/(10**(9)))))**(1/3)
		grain_size(i,j)= 2.*(3./(4.*3.14)*((grain_size(i,j)*0.5)**3*4./3.*3.14+(Dt*velocity/(10**(9)))))**(1./3.)


	ENDDO

ENDDO


Return
end
